<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Calculadora de Inversión</title>

<link rel="manifest" href="./manifest.webmanifest">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon" href="./icon-192.png">

<style>
:root{--bg:#0b1324;--card:#121a2f;--text:#e8eefc;--muted:#9db0d6;--accent:#4d7cff}
html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial}
.wrap{max-width:1000px;margin:12px auto;padding:0 10px}
.card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
h1{font-size:20px;margin:0 0 6px}.muted{color:var(--muted);font-size:13px}
.row{display:flex;gap:8px;flex-wrap:wrap}
input,select{background:#0e1730;border:1px solid #223153;border-radius:10px;padding:12px;color:var(--text);font-size:16px}
input[type="number"]{width:140px}input[type="text"]{flex:1 1 220px}
button{appearance:none;border:none;border-radius:10px;padding:12px 14px;font-weight:700;cursor:pointer;font-size:16px}
.primary{background:var(--accent);color:#fff}.ghost{background:#1a2544;color:var(--text)}.danger{background:#ff6b6b;color:#fff}
table{width:100%;border-collapse:collapse;margin-top:10px}th,td{padding:8px 10px;border-bottom:1px solid #243355;font-size:14px}
th{color:#9db0d6;text-align:left}.right{text-align:right}.tag{display:inline-block;padding:2px 8px;border-radius:999px;font-size:12px}
.income{background:#183f2e;color:#9ff3c7}.cost{background:#402424;color:#f7a4a4}
.kpi{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0}
.kpi .box{background:#0e1730;border:1px solid #223153;border-radius:10px;padding:10px 12px;min-width:160px}
.ok{color:#8ef6b1}.warn{color:#ffd166}.bad{color:#ff9aa2}
.canvasWrap{width:100%;height:320px;background:#0e1730;border:1px solid #223153;border-radius:10px;margin-top:8px}
canvas{width:100%;height:100%;display:block}
@media (max-width:480px){input,select,button{font-size:16px;padding:12px}h1{font-size:18px}}
</style>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./sw.js', { scope: './' });
}
</script>
</head>

<body>
<div class="wrap"><div class="card">
<h1>Calculadora de inversión</h1>
<p class="muted">Añade ingresos/costes por rango (meses desde t=0). En costes puedes indicar interés anual (%). Calcula ROI, TIR y Multiplicador. Genera PDF.</p>

<div class="row" style="margin-top:6px">
  <select id="tipo"><option value="income">Ingreso</option><option value="cost">Coste</option></select>
  <input id="concepto" type="text" placeholder="Concepto">
  <input id="start" type="number" min="0" step="1" placeholder="Inicio m">
  <input id="dur" type="number" min="1" step="1" placeholder="Duración">
  <input id="importe" type="number" step="0.01" inputmode="decimal" placeholder="€ / mes">
  <input id="interes" type="number" step="0.01" inputmode="decimal" placeholder="% anual (costes)">
  <button class="ghost" id="btnAdd">Agregar</button>
  <button class="primary" id="btnCalc">Calcular rentabilidad</button>
</div>

<table id="tabla"><thead><tr>
  <th>Tipo</th><th>Concepto</th><th>Inicio</th><th>Duración</th><th class="right">€ / mes</th><th class="right">% anual</th><th class="right">Acciones</th>
</tr></thead><tbody></tbody>
<tfoot><tr><th colspan="7" class="muted">Costes con interés: €/mes × (1+r/12)^m dentro del rango.</th></tr></tfoot></table>

<div class="kpi" id="kpis" style="display:none">
  <div class="box"><div class="muted">ROI</div><div id="roi" style="font-size:18px">—</div></div>
  <div class="box"><div class="muted">TIR (anual)</div><div id="irr" style="font-size:18px">—</div></div>
  <div class="box"><div class="muted">Multiplicador</div><div id="mult" style="font-size:18px">—</div></div>
  <div class="box"><div class="muted">Rating</div><div id="rating" style="font-size:18px">—</div></div>
</div>

<div class="canvasWrap"><canvas id="chart"></canvas></div>
<div class="row" style="justify-content:flex-end;margin-top:10px">
  <button class="danger" id="btnReset">Reiniciar</button>
  <button class="primary" id="btnPDF">Generar PDF</button>
</div>

</div></div>

<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script>
// --- JavaScript de la calculadora (idéntico al que ya usaste) ---
</script>
</body>
</html>
